{% block body %}

	<div class="card border-0 shadow rounded-3 my-5">
		<div class="card-body row d-flex align-items-center">
			<div class="col-lg-6">
				<h5 class="card-title text-center mb-5 fw-light fs-5">Creation de compte</h5>
				<form class="form-floating" method="post">
					{% if error is defined %}
						{% if error %}
							<div class="alert alert-danger">{{ error.messageKey|trans(error.messageData, 'security') }}</div>
						{% endif %}
					{% endif %}
					{% if app.user  %}
						<div class="mb-3">
							Vous êtes connecté en tant que
							{{ app.user.userIdentifier }},
							<a href="{{ path('app_logout') }}">Déconnexion</a>
						</div>
					{% endif %}

					<div class="form-floating mb-3">
						<input type="text" name="username" placeholder=" " required class="form-control" id="username">
						<label for="username">Nom d'utilisateur</label>
					</div>
					<div class="form-floating mb-3">
						<input type="password" id="floatingPassword" placeholder=" " name="password" required class="form-control">
						<label for="floatingPassword">Mot de passe</label>
					</div>

					{% include 'services/accountservices/role_affectation.html.twig' %}

					<input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">
					<div class="d-grid">
						<button class="btn btn-primary btn-login text-uppercase fw-bold" type="submit">Création du compte</button>
					</div>
					<hr class="my-4">
				</form>
			</div>
			<div class="col-lg-6">
				<table class="table table-striped text-center">
					<thead>
						<tr>
							<th scope="col">Nom d'utilisateur</th>
							<th scope="col">Role</th>
							<th scope="col">Supprimer</th>
						</tr>
					</thead>
					<tbody>
						{% for user in users %}
							{% if app.user.id != user.id and compare_roles(app.user.roles, user.roles) %}
								<tr>
									<td>{{ user.username }}</td>
									<td>{{ user.roles|json_encode|convert_encoding('UTF-8', 'UTF-8') }}</td>
									<td>
										<a href="{{path('app_delete_account', {id: user.id})}}" class="btn btn-danger">
											Supprimer
										</a>
									</td>
								</tr>
							{% endif %}
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
	</div>
{% endblock %}
